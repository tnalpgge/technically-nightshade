<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=referrer content="no-referrer"><meta name=description content><link href="https://fonts.googleapis.com/css?family=Open+Sans:400|Old+Standard+TT:400&display=swap" rel=stylesheet media=print type=text/css onload='this.media="all"'><title>sdrawkcaB gnitirW</title><link rel=canonical href=https://tnalpgge.github.io/technically-nightshade/posts/sdrawkcab-gnitirw/><style>*{border:0;font:inherit;font-size:100%;vertical-align:baseline;margin:0;padding:0;color:#000;text-decoration-skip:ink}body{font-family:open sans,myriad pro,Myriad,sans-serif;font-size:17px;line-height:160%;color:#1d1313;max-width:700px;margin:auto}p{margin:20px 0}a img{border:none}img{margin:10px auto;max-width:100%;display:block}.left-justify{float:left}.right-justify{float:right}pre,code{font:12px Consolas,liberation mono,Menlo,Courier,monospace;background-color:#f7f7f7}code{font-size:12px;padding:4px}pre{margin-top:0;margin-bottom:16px;word-wrap:normal;padding:16px;overflow:auto;font-size:85%;line-height:1.45}pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:0 0;border:0}pre code{display:inline;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}pre code::before,pre code::after{content:normal}em,q,em,dfn{font-style:italic}.sans,html .gist .gist-file .gist-meta{font-family:open sans,myriad pro,Myriad,sans-serif}.mono,pre,code,tt,p code,li code{font-family:Menlo,Monaco,andale mono,lucida console,courier new,monospace}.heading,.serif,h1,h2,h3{font-family:old standard tt,serif}strong{font-weight:600}q:before{content:"\201C"}q:after{content:"\201D"}del,s{text-decoration:line-through}blockquote{font-family:old standard tt,serif;text-align:center;padding:50px}blockquote p{display:inline-block;font-style:italic}blockquote:before,blockquote:after{font-family:old standard tt,serif;content:'\201C';font-size:35px;color:#403c3b}blockquote:after{content:'\201D'}hr{width:40%;height:1px;background:#403c3b;margin:25px auto}h1{font-size:35px}h2{font-size:28px}h3{font-size:22px;margin-top:18px}h1 a,h2 a,h3 a{text-decoration:none}h1,h2{margin-top:28px}#sub-header,.date{color:#403c3b;font-size:13px}#sub-header{margin:0 4px}#nav h1 a{font-size:35px;color:#1d1313;line-height:120%}.posts_listing a,#nav a{text-decoration:none}li{margin-left:20px}ul li{margin-left:5px}ul li{list-style-type:none}ul li:before{content:"\00BB \0020"}#nav ul li:before,.posts_listing li:before{content:'';margin-right:0}#content{text-align:left;width:100%;font-size:15px;padding:60px 0 80px}#content h1,#content h2{margin-bottom:5px}#content h2{font-size:25px}#content .entry-content{margin-top:15px}#content .date{margin-left:3px}#content h1{font-size:30px}.highlight{margin:10px 0}.posts_listing{margin:0 0 50px}.posts_listing li{margin:0 0 25px 15px}.posts_listing li a:hover,#nav a:hover{text-decoration:underline}#nav{text-align:center;position:static;margin-top:60px}#nav ul{display:table;margin:8px auto 0}#nav li{list-style-type:none;display:table-cell;font-size:15px;padding:0 20px}#links{display:flex;justify-content:space-between;margin:50px 0 0}#links :nth-child(1){margin-right:.5em}#links :nth-child(2){margin-left:.5em}#not-found{text-align:center}#not-found a{font-family:old standard tt,serif;font-size:200px;text-decoration:none;display:inline-block;padding-top:225px}@media(max-width:750px){body{padding-left:20px;padding-right:20px}#nav h1 a{font-size:28px}#nav li{font-size:13px;padding:0 15px}#content{margin-top:0;padding-top:50px;font-size:14px}#content h1{font-size:25px}#content h2{font-size:22px}.posts_listing li div{font-size:12px}}@media(max-width:400px){body{padding-left:20px;padding-right:20px}#nav h1 a{font-size:22px}#nav li{font-size:12px;padding:0 10px}#content{margin-top:0;padding-top:20px;font-size:12px}#content h1{font-size:20px}#content h2{font-size:18px}.posts_listing li div{font-size:12px}}@media(prefers-color-scheme:dark){*,#nav h1 a{color:#fdfdfd}body{background:#121212}pre,code{background-color:#262626}#sub-header,.date{color:#bababa}hr{background:#ebebeb}}</style></head><body><section id=nav><h1><a href=/></a></h1><ul><li><a href=/technically-nightshade/>Technically Nightshade</a></li><li><a href=/technically-nightshade/posts/>Posts</a></li><li><a href=/technically-nightshade/posts/generating-royal-history/>Generating Royal History</a></li><li><a href=/technically-nightshade/posts/sdrawkcab-gnitirw/>sdrawkcaB gnitirW</a></li></ul></section><section id=content><h1>sdrawkcaB gnitirW</h1><div id=sub-header>December 2022 Â· 4 minute read</div><div class=entry-content><p>I am no fan of modern office software. I use it under protest and under duress. It&rsquo;s important software to a lot of people, but it feels like dragging a steamer trunk crammed full of clothes and equipment to the corner store at the end of the block when you just want a quick snack. So I look for alternatives in free, <em>libre,</em> and open-source software that are compatible with revision control systems for text files; they can run quite well on older and lower-spec machines.</p><p>When I was sufficiently inspired to write an entire adventure for a popular tabletop role-playing game, I started to look for a way to produce an attractive PDF document with the familiar two-column layout that so many publishers use. I had seen troff used for manual pages, and I had access to plenty of systems that had <a href=https://www.gnu.org/software/groff/>GNU roff</a> (&ldquo;groff&rdquo;) installed. (I had briefly played with <a href=https://www.ctan.org/tex>TeX</a> and its descendant LaTeX back in my university days, and I have a lot of respect for them, but they are not for me.) Since <a href=https://www.freebsd.org/>FreeBSD</a> had evicted many <a href=https://www.gnu.org/licenses/licenses.html#GPL>GPL</a>-licensed tools from their base system since the last time I did any serious <code>roff</code>-ing, I&rsquo;d have to find some useful software to install. Fortunately I stumbled upon the <a href=https://n-t-roff.github.io/heirloom/doctools>Heirloom Documentation Tools</a> (&ldquo;heirloom-doctools&rdquo;). They had me at <em>&ldquo;Plug-and-Play&rdquo; font handling</em> which means that a wide range of fonts was now open to me. (I vaguely remember using custom fonts in groff was painful.)</p><p>I thought that I might use a mix of my usual left-to-right text with tiny sprinkles of right-to-left Hebrew in the adventure. This led me to briefly consider <a href=https://github.com/aligrudi/neatroff>neatroff</a>, but that would require a change in toolset that I wasn&rsquo;t prepared to accept. I ultimately punted on the idea, but I was left with an interesting question. Given that it can deal with UTF-8, <strong>could I teach heirloom-doctools to reverse strings for me?</strong></p><p>As with many problems involving a collection of things, there is a recursive approach and an iterative approach. One cannot truly say one has reversed a string until one has implemented both in the same language. Since I do virtually all of my writing in <a href=https://www.gnu.org/software/emacs>Emacs</a> these days, and Emacs Lisp (well, any Lisp really) lends itself to recursion, I&rsquo;ll start with the recursive version.</p><pre><code class=language-nroff>.\&quot;
.\&quot; Recursively build a reversed string
.\&quot;
.de REVRCSV \&quot; string text
.if '\\$2'' .return
.lds orig \\$2
.lds tail \\*[orig]
.substring tail -1
.ie '\\*[tail]' ' .as \\$1 \ \&quot; intentional space at end of line
.el .as \\$1 \\*[tail]
.chop orig
.REVRCSV \\$1 &quot;\\*[orig]&quot;
..
</code></pre><p>Contrast with the iterative version.</p><pre><code class=language-nroff>.\&quot;
.\&quot; Iteratively build a reversed string
.\&quot;
.de REVITER \&quot; string text
.ds \\$1
.lds orig \\$2
.length reviter \\*[orig]
.while \\n[reviter]&gt;0 \{\
.lds tail \\*[orig]
.substring tail -1
.ie '\\*[tail]' ' .as \\$1 \ \&quot; intentional space at end of line
.el .as \\$1 \\*[tail]
.chop orig
.length reviter \\*[orig]
\}
..
</code></pre><p>The calling convention for both is to define a string to store the result and to provide the text to be reversed. Then you can use the new string in other ways, or perhaps immediately place it in the output.</p><pre><code class=language-nroff>.do xflag 3
.lc_ctype en_US.UTF-8
.hylang en_US
.mediasize letter
.\&quot; insert macro definitions here
.REVRCSV rrr troff
.br
recursively: \*[rrr]
.REVITER iii troff
.br
iteratively: \*[iii]
</code></pre><p>Save the file as <code>ffort.tr</code> and compute your reversed strings!</p><pre><code class=language-text>$ nroff ffort.tr  | uniq
recursively: ffort
iteratively: ffort
</code></pre><p>Both the recursive and versions are about the same length, which is moderately surprising. And so far neither version has been directly useful in my writing as of yet, but I remain hopeful. Benchmarking them, I found that 10,000 iterations of the iterative version took about 4.5 seconds on my machine, and only 1,000 iterations of the recursive version took about 16.6 seconds. The iterative version is clearly faster. I still think the recursive version is more fun.</p></div><div id=links><a href=https://tnalpgge.github.io/technically-nightshade/posts/generating-royal-history/>&#171;&nbsp;Generating Royal History</a></div></section></body></html>